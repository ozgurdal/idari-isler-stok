import streamlit as st
import pandas as pd
from datetime import datetime

# 1. PERSONEL LÄ°STESÄ° (Ã–rnek Liste - Ä°stediÄŸiniz kadar ekleyebiliriz)
personel_listesi = ["Ahmet YÄ±lmaz", "Mehmet Demir", "AyÅŸe Kaya", "Caner Uzun", "Selin BakÄ±r"]

# 2. ÃœRÃœN VERÄ° TABANI (Barkod, ÃœrÃ¼n AdÄ±, BaÅŸlangÄ±Ã§ StoÄŸu)
# GerÃ§ek barkodlarÄ±nÄ±z geldiÄŸinde bu alanÄ± gÃ¼ncelleyeceÄŸiz
urunler = {
    "111222333": {"ad": "Kalem", "stok": 100},
    "444555666": {"ad": "Hareketli Havlu", "stok": 50},
    "777888999": {"ad": "Mop", "stok": 20}
}

st.title("ğŸš€ Ä°dari Ä°ÅŸler AkÄ±llÄ± Stok Paneli")

# --- SOL MENÃœ ---
islem = st.sidebar.selectbox("LÃ¼tfen Ä°ÅŸlem SeÃ§in", ["Barkodla ÃœrÃ¼n Ã‡Ä±kÄ±ÅŸÄ±", "Stok Ä°zleme", "Rapor Sorgulama"])

if islem == "Barkodla ÃœrÃ¼n Ã‡Ä±kÄ±ÅŸÄ±":
    st.subheader("ğŸ“¦ ÃœrÃ¼n TeslimatÄ±")
    
    # AKILLI ARAMA KUTUSU: Personel Listesi
    secilen_personel = st.selectbox("ÃœrÃ¼nÃ¼ Teslim Alan Personel:", [""] + personel_listesi)
    
    # BARKOD GÄ°RÄ°ÅÄ° (Kamera entegrasyonu buraya baÄŸlanÄ±r)
    barkod_input = st.text_input("Barkodu Okutun (Kamera OdaklÄ±):")
    
    adet = st.number_input("Teslim Edilecek Adet:", min_value=1, value=1)

    if st.button("Ä°ÅŸlemi Tamamla"):
        if barkod_input in urunler and secilen_personel != "":
            urun_adi = urunler[barkod_input]["ad"]
            st.success(f"Ä°ÅŸlem OnaylandÄ±: {secilen_personel} kiÅŸisine {adet} adet {urun_adi} verildi.")
            # Burada veritabanÄ± (Google Sheets/SQLite) gÃ¼ncelleme kodu Ã§alÄ±ÅŸÄ±r.
        else:
            st.error("LÃ¼tfen geÃ§erli bir barkod ve personel seÃ§tiÄŸinizden emin olun!")

elif islem == "Stok Ä°zleme":
    st.subheader("ğŸ“‹ GÃ¼ncel Depo Durumu")
    st.table(pd.DataFrame.from_dict(urunler, orient='index'))

elif islem == "Rapor Sorgulama":
    st.subheader("ğŸ” GeÃ§miÅŸ Hareket Sorgulama")
    # Filtreleme SeÃ§enekleri
    search_query = st.text_input("Personel adÄ±na gÃ¶re filtreleyin:")
    st.info("Sorgu sonucu aÅŸaÄŸÄ±da listelenecektir...")